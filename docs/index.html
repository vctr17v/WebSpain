<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cuenta atrás hasta las 22:00</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="overlay"></div>
  <main class="contenedor">
    <h1>Cuenta atrás hasta las 22:00 (hora España)</h1>
    <div id="countdown" aria-live="polite" class="countdown">
      <div class="segment"><span id="hours">00</span><small>Horas</small></div>
      <div class="segment"><span id="minutes">00</span><small>Minutos</small></div>
      <div class="segment"><span id="seconds">00</span><small>Segundos</small></div>
    </div>
    <p id="finalizado" class="finalizado" hidden>¡Ya son las 22:00! ✨</p>
  </main>
  <script>
    // Diferencia (en segundos) hasta las 22:00 de hoy/mañana en Europe/Madrid
    function segundosHastaLas22Madrid() {
      const ahora = new Date();
      const formato = new Intl.DateTimeFormat('en-GB', {
        timeZone: 'Europe/Madrid',
        hour12: false,
        hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
      const partes = formato.formatToParts(ahora).reduce((acc,p)=>{acc[p.type]=p.value;return acc;},{});
      const h = parseInt(partes.hour, 10) || 0;
      const m = parseInt(partes.minute, 10) || 0;
      const s = parseInt(partes.second, 10) || 0;
      const actual = h*3600 + m*60 + s;
      const objetivo = 22*3600; // 22:00:00
      if (actual <= objetivo) {
        return (objetivo - actual);
      } else {
        // Ya pasó: faltan las horas hasta medianoche + 22h del día siguiente
        return (24*3600 - (actual - objetivo));
      }
    }

    function actualizar() {
      const totalSeg = segundosHastaLas22Madrid();
      const finalizado = (totalSeg === 0);
      document.getElementById('finalizado').hidden = !finalizado;
      document.getElementById('countdown').style.display = finalizado ? 'none' : '';
      if (finalizado) return;

      const horas = Math.floor(totalSeg / 3600);
      const minutos = Math.floor((totalSeg % 3600) / 60);
      const segundos = totalSeg % 60;
      document.getElementById('hours').textContent = String(horas).padStart(2,'0');
      document.getElementById('minutes').textContent = String(minutos).padStart(2,'0');
      document.getElementById('seconds').textContent = String(segundos).padStart(2,'0');
    }

    actualizar();
    setInterval(actualizar, 1000);
  </script>
</body>
</html>
